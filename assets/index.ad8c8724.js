var M=Object.defineProperty,H=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var B=(e,t,r)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y=(e,t)=>{for(var r in t||(t={}))q.call(t,r)&&B(e,r,t[r]);if(I)for(var r of I(t))V.call(t,r)&&B(e,r,t[r]);return e},w=(e,t)=>H(e,X(t));import{r as p,j as n,X as N,C as O,a as x,B as R,t as S,A as W,b as J,c as K,d as $,e as G,T as Q,f as E,g as P,R as U,h as Y}from"./vendor.923eb19d.js";const Z=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}};Z();function*ee(){let e=1;for(;;)yield e,e++}const te=ee();function re(e){const[t,r]=p.exports.useState(!1),[l,o]=p.exports.useState(!1),s=c=>{const k=new FileReader;o(!1),r(!0),k.onload=b=>{var d;try{const h=(d=b==null?void 0:b.target)==null?void 0:d.result,A=N.read(h,{type:"array"}),z=A.SheetNames[1],F=A.Sheets[z];let u=N.utils.sheet_to_json(F,{header:1}),L;for(;L=u[0],!!L;)if(typeof L[11]!="string")u.shift();else break;if(u.shift(),u.length===0)throw new Error("");u=u.filter(a=>Boolean(a[11])||Boolean(a[12])||Boolean(a[15]));const m=[],T=u.map(a=>{var v,_;const i={kee:((v=a[6])==null?void 0:v.toString())||"_"+te.next().value,division:a[11]?+a[11].slice(1):void 0,parent:(_=a[12])==null?void 0:_.toString(),_temp:a[13],title:a[15],_children:[]};if(m.length===0)return m.unshift(i),i;if(i.parent){const f=m.find(C=>C.kee===i.parent);f&&f._children.push(i)}else{const f=m.find(C=>typeof i.division=="number"?C.division<i.division:!0);f?(f._children.push(i),i.parent=f==null?void 0:f.kee):m.unshift(i)}return i.division&&m.unshift(i),i});console.log(T);let g=T.reduce((a,i)=>{if(typeof i.division!="number")return a;const v=a[0];return!v||i.division===v.division?(a.push(i),a):i.division<v.division?[i]:a},[]);if(console.log(g),g.length===1&&(g=g[0]._children),!g||g.length===0)throw new Error("");e.setData(g)}catch(h){console.log(h),setTimeout(()=>{r(!1),o(!0)},100)}},setTimeout(()=>k.readAsArrayBuffer(c),10)};return n(ne,{handleFile:s,children:n(oe,{handleFile:s,isLoading:t,error:l})})}function ne({handleFile:e,children:t}){const[r,l]=p.exports.useState(!1),o=p.exports.useRef(null);return n(O,{height:"100%",width:"100%",p:10,children:n(O,{borderColor:r?"rgba(0, 150, 0, 1)":"transparent",backgroundColor:r?"rgba(0, 150, 0, 0.4)":"transparent",transition:"all 0.3s ease",height:"100%",width:"100%",borderWidth:1,borderRadius:10,borderStyle:"solid",onDrop:d=>{d.stopPropagation(),d.preventDefault(),l(!1);const h=d.dataTransfer.files;h&&h[0]&&e(h[0])},onDragEnterCapture:d=>{d.stopPropagation(),d.preventDefault()},onDragOverCapture:d=>{l(!0),d.stopPropagation(),d.preventDefault()},onDragLeaveCapture:d=>{l(!1),d.stopPropagation(),d.preventDefault()},ref:o,children:t})})}function oe({handleFile:e,isLoading:t,error:r}){const l=s=>{const c=s.target.files;c&&c[0]&&e(c[0])},o=p.exports.useRef(null);return n("form",{children:x(R,{onClick:s=>{var c;return(c=o.current)==null?void 0:c.click()},isLoading:t,borderColor:r?"red":"transparent",borderWidth:2,children:["Drag or choose a spreadsheet file",n("input",{type:"file",id:"file",accept:ie,onChange:l,style:{display:"none"},ref:o})]})})}const ie=["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map(e=>`.${e}`).join(",");var D={frame:S({position:"relative",padding:"4px 0px 0px 0px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflowX:"hidden",verticalAlign:"middle",color:"black",fill:"black",fontSize:14}),title:S({verticalAlign:"middle"}),content:S({willChange:"transform, opacity, height",marginLeft:7,padding:"0px 0px 0px 14px",borderLeft:"1px dashed rgba(0, 0, 0, 0.4)",overflow:"hidden"}),toggle:S({width:15,height:15,marginRight:10,cursor:"pointer",verticalAlign:"middle",userSelect:"none"})};const j=p.exports.memo(e=>{var t,r;return e._children.length!==0?n(W,{allowToggle:!0,children:x(J,{children:[x(K,{css:{padding:5,background:"transparent",border:0,cursor:"pointer",maxWidth:"max-content"},children:[n($,{css:{marginLeft:"-4px",marginRight:8}}),(t=e.title)!=null?t:"NO TITLE "+e._temp]}),n(G,{pb:4,children:n("div",{className:D.content(),children:e._children.map(l=>p.exports.createElement(j,w(y({},l),{key:l.kee})))})})]})}):n("div",{className:D.frame(),children:x("div",{style:{display:"flex",alignItems:"center",willChange:"transform",gap:4},children:[n(se,{className:D.toggle()}),n(Q,{className:D.title(),style:{fontFamily:"inherit",fontSize:16},children:(r=e.title)!=null?r:"NO TITLE "+e._temp})]})})}),se=e=>n("svg",w(y({},e),{viewBox:"0 0 24 24",width:16,children:n("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"})}));function ae(){const[e,t]=p.exports.useState([]);return x(p.exports.Suspense,{fallback:null,children:[e.length===0?n(E,{children:n(re,{setData:t})}):n(E,{children:n(P,{p:5,children:n(R,{onClick:r=>t([]),children:"Reset"})})}),e.length>0&&n(P,{p:20,paddingTop:0,children:e.map((r,l)=>n(j,w(y({},r),{defaultOpen:!0}),l))})]})}U.render(n(Y.StrictMode,{children:n(ae,{})}),document.getElementById("root"));
