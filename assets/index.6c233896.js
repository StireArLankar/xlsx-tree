var H=Object.defineProperty,X=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var I=(e,t,r)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,w=(e,t)=>{for(var r in t||(t={}))V.call(t,r)&&I(e,r,t[r]);if(_)for(var r of _(t))W.call(t,r)&&I(e,r,t[r]);return e},S=(e,t)=>X(e,q(t));import{r as p,j as i,X as B,C as E,a as v,B as N,t as D,A as J,b as K,c as $,d as G,e as Q,T as U,f as O,g as R,R as Y,h as Z}from"./vendor.923eb19d.js";const ee=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&d(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function d(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}};ee();function*te(){let e=1;for(;;)yield e,e++}const re=te();function ne(e){const[t,r]=p.exports.useState(!1),[d,n]=p.exports.useState(!1),a=c=>{const L=new FileReader;n(!1),r(!0),L.onload=x=>{var l;try{const f=(l=x==null?void 0:x.target)==null?void 0:l.result,A=B.read(f,{type:"array"}),j=A.SheetNames[1],z=A.Sheets[j];let h=B.utils.sheet_to_json(z,{header:1}),C;for(;C=h[0],!!C;)if(typeof C[11]!="string")h.shift();else break;if(h.shift(),h.length===0)throw new Error("");h=h.filter(o=>Boolean(o[11])||Boolean(o[12])||Boolean(o[15]));const m=[],b=h.map(o=>{var g,T;const s={kee:((g=o[6])==null?void 0:g.toString())||"_"+re.next().value,division:o[11]?+o[11].slice(1):void 0,parent:(T=o[12])==null?void 0:T.toString(),_temp:o[13],title:o[15],_children:[]};if(m.length===0)return m.unshift(s),s;if(!s.parent){const y=m.find(M=>typeof s.division=="number"?M.division<s.division:!0);y?s.parent=y==null?void 0:y.kee:m.unshift(s)}return s.division&&m.unshift(s),s}),F=b.reduce((o,s)=>(o[s.kee]=s,o),{});b.forEach(o=>{const s=F[o.parent];!s||s._children.push(o)}),console.log(b);let u=b.reduce((o,s)=>{if(typeof s.division!="number")return o;const g=o[0];return!g||s.division===g.division?(o.push(s),o):s.division<g.division?[s]:o},[]);if(console.log(u),u.length===1&&(u=u[0]._children),!u||u.length===0)throw new Error("");e.setData(u)}catch(f){console.log(f),setTimeout(()=>{r(!1),n(!0)},100)}},setTimeout(()=>L.readAsArrayBuffer(c),10)};return i(oe,{handleFile:a,children:i(ie,{handleFile:a,isLoading:t,error:d})})}function oe({handleFile:e,children:t}){const[r,d]=p.exports.useState(!1),n=p.exports.useRef(null);return i(E,{height:"100%",width:"100%",p:10,children:i(E,{borderColor:r?"rgba(0, 150, 0, 1)":"transparent",backgroundColor:r?"rgba(0, 150, 0, 0.4)":"transparent",transition:"all 0.3s ease",height:"100%",width:"100%",borderWidth:1,borderRadius:10,borderStyle:"solid",onDrop:l=>{l.stopPropagation(),l.preventDefault(),d(!1);const f=l.dataTransfer.files;f&&f[0]&&e(f[0])},onDragEnterCapture:l=>{l.stopPropagation(),l.preventDefault()},onDragOverCapture:l=>{d(!0),l.stopPropagation(),l.preventDefault()},onDragLeaveCapture:l=>{d(!1),l.stopPropagation(),l.preventDefault()},ref:n,children:t})})}function ie({handleFile:e,isLoading:t,error:r}){const d=a=>{const c=a.target.files;c&&c[0]&&e(c[0])},n=p.exports.useRef(null);return i("form",{children:v(N,{onClick:a=>{var c;return(c=n.current)==null?void 0:c.click()},isLoading:t,borderColor:r?"red":"transparent",borderWidth:2,children:["Drag or choose a spreadsheet file",i("input",{type:"file",id:"file",accept:se,onChange:d,style:{display:"none"},ref:n})]})})}const se=["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map(e=>`.${e}`).join(",");var k={frame:D({position:"relative",padding:"4px 0px 0px 0px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflowX:"hidden",verticalAlign:"middle",color:"black",fill:"black",fontSize:14}),title:D({verticalAlign:"middle"}),content:D({willChange:"transform, opacity, height",marginLeft:7,padding:"0px 0px 0px 14px",borderLeft:"1px dashed rgba(0, 0, 0, 0.4)",overflow:"hidden"}),toggle:D({width:15,height:15,marginRight:10,cursor:"pointer",verticalAlign:"middle",userSelect:"none"})};const P=p.exports.memo(e=>{var t,r;return e._children.length!==0?i(J,{allowToggle:!0,children:v(K,{children:[v($,{css:{padding:5,background:"transparent",border:0,cursor:"pointer",maxWidth:"max-content"},children:[i(G,{css:{marginLeft:"-4px",marginRight:8}}),(t=e.title)!=null?t:"NO TITLE "+e._temp]}),i(Q,{pb:4,children:i("div",{className:k.content(),children:e._children.map((d,n)=>p.exports.createElement(P,S(w({},d),{key:n})))})})]})}):i("div",{className:k.frame(),children:v("div",{style:{display:"flex",alignItems:"center",willChange:"transform",gap:4},children:[i(ae,{className:k.toggle()}),i(U,{className:k.title(),style:{fontFamily:"inherit",fontSize:16},children:(r=e.title)!=null?r:"NO TITLE "+e._temp})]})})}),ae=e=>i("svg",S(w({},e),{viewBox:"0 0 24 24",width:16,children:i("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"})}));function le(){const[e,t]=p.exports.useState([]);return v(p.exports.Suspense,{fallback:null,children:[e.length===0?i(O,{children:i(ne,{setData:t})}):i(O,{children:i(R,{p:5,children:i(N,{onClick:r=>t([]),children:"Reset"})})}),e.length>0&&i(R,{p:20,paddingTop:0,children:e.map((r,d)=>i(P,S(w({},r),{defaultOpen:!0}),d))})]})}Y.render(i(Z.StrictMode,{children:i(le,{})}),document.getElementById("root"));
