var M=Object.defineProperty,H=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var I=(e,t,r)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y=(e,t)=>{for(var r in t||(t={}))q.call(t,r)&&I(e,r,t[r]);if(_)for(var r of _(t))V.call(t,r)&&I(e,r,t[r]);return e},w=(e,t)=>H(e,X(t));import{r as p,j as n,X as B,C as N,a as x,B as O,t as S,A as W,b as J,c as K,d as $,e as G,T as Q,f as R,g as E,R as U,h as Y}from"./vendor.923eb19d.js";const Z=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};Z();function*ee(){let e=1;for(;;)yield e,e++}const te=ee();function re(e){const[t,r]=p.exports.useState(!1),[l,o]=p.exports.useState(!1),i=c=>{const k=new FileReader;o(!1),r(!0),k.onload=b=>{var d;try{const f=(d=b==null?void 0:b.target)==null?void 0:d.result,C=B.read(f,{type:"array"}),j=C.SheetNames[1],z=C.Sheets[j];let h=B.utils.sheet_to_json(z,{header:1}),L;for(;L=h[0],!!L;)if(typeof L[11]!="string")h.shift();else break;if(h.shift(),h.length===0)throw new Error("");h=h.filter(s=>Boolean(s[11])||Boolean(s[12])||Boolean(s[15]));const m=[],A=h.map(s=>{var g,T;const a={kee:((g=s[6])==null?void 0:g.toString())||"_"+te.next().value,division:s[11]?+s[11].slice(1):void 0,parent:(T=s[12])==null?void 0:T.toString(),_temp:s[13],title:s[15],_children:[]};if(m.length===0)return m.unshift(a),a;if(!a.parent){const v=m.find(F=>typeof a.division=="number"?F.division<a.division:!0);v?(v._children.push(a),a.parent=v==null?void 0:v.kee):m.unshift(a)}return a.division&&m.unshift(a),a});console.log(A);let u=A.reduce((s,a)=>{if(typeof a.division!="number")return s;const g=s[0];return!g||a.division===g.division?(s.push(a),s):a.division<g.division?[a]:s},[]);if(console.log(u),u.length===1&&(u=u[0]._children),!u||u.length===0)throw new Error("");e.setData(u)}catch(f){console.log(f),setTimeout(()=>{r(!1),o(!0)},100)}},setTimeout(()=>k.readAsArrayBuffer(c),10)};return n(ne,{handleFile:i,children:n(oe,{handleFile:i,isLoading:t,error:l})})}function ne({handleFile:e,children:t}){const[r,l]=p.exports.useState(!1),o=p.exports.useRef(null);return n(N,{height:"100%",width:"100%",p:10,children:n(N,{borderColor:r?"rgba(0, 150, 0, 1)":"transparent",backgroundColor:r?"rgba(0, 150, 0, 0.4)":"transparent",transition:"all 0.3s ease",height:"100%",width:"100%",borderWidth:1,borderRadius:10,borderStyle:"solid",onDrop:d=>{d.stopPropagation(),d.preventDefault(),l(!1);const f=d.dataTransfer.files;f&&f[0]&&e(f[0])},onDragEnterCapture:d=>{d.stopPropagation(),d.preventDefault()},onDragOverCapture:d=>{l(!0),d.stopPropagation(),d.preventDefault()},onDragLeaveCapture:d=>{l(!1),d.stopPropagation(),d.preventDefault()},ref:o,children:t})})}function oe({handleFile:e,isLoading:t,error:r}){const l=i=>{const c=i.target.files;c&&c[0]&&e(c[0])},o=p.exports.useRef(null);return n("form",{children:x(O,{onClick:i=>{var c;return(c=o.current)==null?void 0:c.click()},isLoading:t,borderColor:r?"red":"transparent",borderWidth:2,children:["Drag or choose a spreadsheet file",n("input",{type:"file",id:"file",accept:ie,onChange:l,style:{display:"none"},ref:o})]})})}const ie=["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map(e=>`.${e}`).join(",");var D={frame:S({position:"relative",padding:"4px 0px 0px 0px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflowX:"hidden",verticalAlign:"middle",color:"black",fill:"black",fontSize:14}),title:S({verticalAlign:"middle"}),content:S({willChange:"transform, opacity, height",marginLeft:7,padding:"0px 0px 0px 14px",borderLeft:"1px dashed rgba(0, 0, 0, 0.4)",overflow:"hidden"}),toggle:S({width:15,height:15,marginRight:10,cursor:"pointer",verticalAlign:"middle",userSelect:"none"})};const P=p.exports.memo(e=>{var t,r;return e._children.length!==0?n(W,{allowToggle:!0,children:x(J,{children:[x(K,{css:{padding:5,background:"transparent",border:0,cursor:"pointer",maxWidth:"max-content"},children:[n($,{css:{marginLeft:"-4px",marginRight:8}}),(t=e.title)!=null?t:"NO TITLE "+e._temp]}),n(G,{pb:4,children:n("div",{className:D.content(),children:e._children.map(l=>p.exports.createElement(P,w(y({},l),{key:l.kee})))})})]})}):n("div",{className:D.frame(),children:x("div",{style:{display:"flex",alignItems:"center",willChange:"transform",gap:4},children:[n(se,{className:D.toggle()}),n(Q,{className:D.title(),style:{fontFamily:"inherit",fontSize:16},children:(r=e.title)!=null?r:"NO TITLE "+e._temp})]})})}),se=e=>n("svg",w(y({},e),{viewBox:"0 0 24 24",width:16,children:n("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"})}));function ae(){const[e,t]=p.exports.useState([]);return x(p.exports.Suspense,{fallback:null,children:[e.length===0?n(R,{children:n(re,{setData:t})}):n(R,{children:n(E,{p:5,children:n(O,{onClick:r=>t([]),children:"Reset"})})}),e.length>0&&n(E,{p:20,paddingTop:0,children:e.map((r,l)=>n(P,w(y({},r),{defaultOpen:!0}),l))})]})}U.render(n(Y.StrictMode,{children:n(ae,{})}),document.getElementById("root"));
