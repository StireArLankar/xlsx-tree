var F=Object.defineProperty,H=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var B=(e,t,n)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,y=(e,t)=>{for(var n in t||(t={}))V.call(t,n)&&B(e,n,t[n]);if(R)for(var n of R(t))X.call(t,n)&&B(e,n,t[n]);return e},b=(e,t)=>H(e,G(t));import{r as p,j as r,X as M,C as T,a as x,B as N,t as w,A as q,b as _,c as J,d as W,e as K,T as $,f as O,g as z,R as Q,h as U}from"./vendor.923eb19d.js";const Y=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))d(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&d(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function d(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}};Y();function Z(e){const[t,n]=p.exports.useState(!1),[d,o]=p.exports.useState(!1),a=i=>{const S=new FileReader;o(!1),n(!0),S.onload=m=>{var l;try{const u=(l=m==null?void 0:m.target)==null?void 0:l.result,C=M.read(u,{type:"array"}),P=C.SheetNames[1],j=C.Sheets[P],I=M.utils.sheet_to_json(j,{header:1}).map(s=>s[11]?{type:"branch",key:s[6],indexInGroup:s[10],pos:+s[11].slice(1),parent:s[12],title:s[15],nodes:[]}:{type:"leaf",key:s[6],indexInGroup:s[10],pos:0,parent:s[12],title:s[15]}).filter(s=>Boolean(s.indexInGroup)).slice(2).reduce((s,h)=>{const c=s.length-1;return h.indexInGroup==="1"?s.push([h]):s[c].push(h),s},[]);let f;if(I.forEach(s=>s.reduce((h,c)=>{var k,L,A;if(c.pos){const g=h.slice().reverse().find(v=>(v==null?void 0:v.pos)&&v.pos<c.pos);c.parent=(k=g==null?void 0:g.key)!=null?k:"",g&&"nodes"in g&&((L=g.nodes)==null||L.push(c)),f=c}else f&&"nodes"in f&&((A=f.nodes)==null||A.push(c)),c.parent=f==null?void 0:f.key;return h.push(c),h},[])),e.setData(I.map(s=>s[0])),I.length===0)throw new Error("")}catch(u){console.log(u),setTimeout(()=>{n(!1),o(!0)},100)}},setTimeout(()=>S.readAsArrayBuffer(i),10)};return r(ee,{handleFile:a,children:r(te,{handleFile:a,isLoading:t,error:d})})}function ee({handleFile:e,children:t}){const[n,d]=p.exports.useState(!1),o=p.exports.useRef(null);return r(T,{height:"100%",width:"100%",p:10,children:r(T,{borderColor:n?"rgba(0, 150, 0, 1)":"transparent",backgroundColor:n?"rgba(0, 150, 0, 0.4)":"transparent",transition:"all 0.3s ease",height:"100%",width:"100%",borderWidth:1,borderRadius:10,borderStyle:"solid",onDrop:l=>{l.stopPropagation(),l.preventDefault(),d(!1);const u=l.dataTransfer.files;u&&u[0]&&e(u[0])},onDragEnterCapture:l=>{l.stopPropagation(),l.preventDefault()},onDragOverCapture:l=>{d(!0),l.stopPropagation(),l.preventDefault()},onDragLeaveCapture:l=>{d(!1),l.stopPropagation(),l.preventDefault()},ref:o,children:t})})}function te({handleFile:e,isLoading:t,error:n}){const d=a=>{const i=a.target.files;i&&i[0]&&e(i[0])},o=p.exports.useRef(null);return r("form",{children:x(N,{onClick:a=>{var i;return(i=o.current)==null?void 0:i.click()},isLoading:t,borderColor:n?"red":"transparent",borderWidth:2,children:["Drag or choose a spreadsheet file",r("input",{type:"file",id:"file",accept:re,onChange:d,style:{display:"none"},ref:o})]})})}const re=["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map(e=>`.${e}`).join(",");var D={frame:w({position:"relative",padding:"4px 0px 0px 0px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflowX:"hidden",verticalAlign:"middle",color:"black",fill:"black",fontSize:14}),title:w({verticalAlign:"middle"}),content:w({willChange:"transform, opacity, height",marginLeft:7,padding:"0px 0px 0px 14px",borderLeft:"1px dashed rgba(0, 0, 0, 0.4)",overflow:"hidden"}),toggle:w({width:15,height:15,marginRight:10,cursor:"pointer",verticalAlign:"middle",userSelect:"none"})};const E=p.exports.memo(e=>e.type==="branch"?r(q,{defaultIndex:[],allowMultiple:!0,children:x(_,{children:[x(J,{css:{padding:5,background:"transparent",border:0,cursor:"pointer"},children:[r(W,{css:{marginLeft:"-4px",marginRight:8}}),e.title]}),r(K,{pb:4,children:r("div",{className:D.content(),children:e.nodes.map(t=>p.exports.createElement(E,b(y({},t),{key:t.title})))})})]})}):r("div",{className:D.frame(),children:x("div",{style:{display:"flex",alignItems:"center",willChange:"transform",gap:4},children:[r(oe,{className:D.toggle()}),r($,{className:D.title(),style:{fontFamily:"inherit",fontSize:16},children:e.title}),e.meta?r(ne,{}):null]})})),ne=()=>r("svg",{viewBox:"0 0 24 24",width:16,children:r("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2z"})}),oe=e=>r("svg",b(y({},e),{viewBox:"0 0 24 24",width:16,children:r("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"})}));function se(){const[e,t]=p.exports.useState([]);return x(p.exports.Suspense,{fallback:null,children:[e.length===0?r(O,{children:r(Z,{setData:t})}):r(O,{children:r(z,{p:5,children:r(N,{onClick:n=>t([]),children:"Reset"})})}),r(z,{p:20,paddingTop:0,children:e.map(n=>r(E,b(y({},n),{defaultOpen:!0}),n.title))})]})}Q.render(r(U.StrictMode,{children:r(se,{})}),document.getElementById("root"));
