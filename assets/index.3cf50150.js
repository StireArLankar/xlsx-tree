var F=Object.defineProperty,M=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var T=(e,t,r)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y=(e,t)=>{for(var r in t||(t={}))X.call(t,r)&&T(e,r,t[r]);if(A)for(var r of A(t))q.call(t,r)&&T(e,r,t[r]);return e},w=(e,t)=>M(e,H(t));import{r as f,j as o,X as I,C as B,a as v,B as E,t as D,A as V,b as J,c as W,d as K,e as $,T as G,f as N,g as O,R as Q,h as U}from"./vendor.923eb19d.js";const Y=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&d(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function d(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}};Y();function*Z(){let e=1;for(;;)yield e,e++}const ee=Z();function te(e){const[t,r]=f.exports.useState(!1),[d,n]=f.exports.useState(!1),a=c=>{const k=new FileReader;n(!1),r(!0),k.onload=x=>{var l;try{const h=(l=x==null?void 0:x.target)==null?void 0:l.result,C=I.read(h,{type:"array"}),_=C.SheetNames[1],P=C.Sheets[_];let u=I.utils.sheet_to_json(P,{header:1}),L;for(;L=u[0],!!L;)if(typeof L[11]!="string")u.shift();else break;if(u.shift(),u.length===0)throw new Error("");u=u.filter(i=>Boolean(i[11])||Boolean(i[12])||Boolean(i[15]));const m=[],b=u.map(i=>{const s={kee:i[6]||"_"+ee.next().value,division:i[11]?+i[11].slice(1):void 0,parent:i[12],title:i[15],_children:[]};if(m.length===0)return m.unshift(s),s;if(!s.parent){const p=m.find(z=>typeof s.division=="number"?z.division<s.division:!0);p?s.parent=p==null?void 0:p.kee:m.unshift(s)}return s.division&&m.unshift(s),s}),j=b.reduce((i,s)=>(i[s.kee]=s,i),{});b.forEach(i=>{const s=j[i.parent];!s||s._children.push(i)}),console.log(b);let g=b.reduce((i,s)=>{if(typeof s.division!="number")return i;const p=i[0];return!p||s.division===p.division?(i.push(s),i):s.division<p.division?[s]:i},[]);if(console.log(g),g.length===1&&(g=g[0]._children),!g||g.length===0)throw new Error("");e.setData(g)}catch(h){console.log(h),setTimeout(()=>{r(!1),n(!0)},100)}},setTimeout(()=>k.readAsArrayBuffer(c),10)};return o(re,{handleFile:a,children:o(ne,{handleFile:a,isLoading:t,error:d})})}function re({handleFile:e,children:t}){const[r,d]=f.exports.useState(!1),n=f.exports.useRef(null);return o(B,{height:"100%",width:"100%",p:10,children:o(B,{borderColor:r?"rgba(0, 150, 0, 1)":"transparent",backgroundColor:r?"rgba(0, 150, 0, 0.4)":"transparent",transition:"all 0.3s ease",height:"100%",width:"100%",borderWidth:1,borderRadius:10,borderStyle:"solid",onDrop:l=>{l.stopPropagation(),l.preventDefault(),d(!1);const h=l.dataTransfer.files;h&&h[0]&&e(h[0])},onDragEnterCapture:l=>{l.stopPropagation(),l.preventDefault()},onDragOverCapture:l=>{d(!0),l.stopPropagation(),l.preventDefault()},onDragLeaveCapture:l=>{d(!1),l.stopPropagation(),l.preventDefault()},ref:n,children:t})})}function ne({handleFile:e,isLoading:t,error:r}){const d=a=>{const c=a.target.files;c&&c[0]&&e(c[0])},n=f.exports.useRef(null);return o("form",{children:v(E,{onClick:a=>{var c;return(c=n.current)==null?void 0:c.click()},isLoading:t,borderColor:r?"red":"transparent",borderWidth:2,children:["Drag or choose a spreadsheet file",o("input",{type:"file",id:"file",accept:oe,onChange:d,style:{display:"none"},ref:n})]})})}const oe=["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map(e=>`.${e}`).join(",");var S={frame:D({position:"relative",padding:"4px 0px 0px 0px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflowX:"hidden",verticalAlign:"middle",color:"black",fill:"black",fontSize:14}),title:D({verticalAlign:"middle"}),content:D({willChange:"transform, opacity, height",marginLeft:7,padding:"0px 0px 0px 14px",borderLeft:"1px dashed rgba(0, 0, 0, 0.4)",overflow:"hidden"}),toggle:D({width:15,height:15,marginRight:10,cursor:"pointer",verticalAlign:"middle",userSelect:"none"})};const R=f.exports.memo(e=>{var t,r;return e._children.length!==0?o(V,{allowToggle:!0,children:v(J,{children:[v(W,{css:{padding:5,background:"transparent",border:0,cursor:"pointer"},children:[o(K,{css:{marginLeft:"-4px",marginRight:8}}),(t=e.title)!=null?t:"NO TITLE "+e.kee]}),o($,{pb:4,children:o("div",{className:S.content(),children:e._children.map((d,n)=>f.exports.createElement(R,w(y({},d),{key:n})))})})]})}):o("div",{className:S.frame(),children:v("div",{style:{display:"flex",alignItems:"center",willChange:"transform",gap:4},children:[o(ie,{className:S.toggle()}),o(G,{className:S.title(),style:{fontFamily:"inherit",fontSize:16},children:(r=e.title)!=null?r:"NO TITLE "+e.kee})]})})}),ie=e=>o("svg",w(y({},e),{viewBox:"0 0 24 24",width:16,children:o("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"})}));function se(){const[e,t]=f.exports.useState([]);return v(f.exports.Suspense,{fallback:null,children:[e.length===0?o(N,{children:o(te,{setData:t})}):o(N,{children:o(O,{p:5,children:o(E,{onClick:r=>t([]),children:"Reset"})})}),e.length>0&&o(O,{p:20,paddingTop:0,children:e.map((r,d)=>o(R,w(y({},r),{defaultOpen:!0}),d))})]})}Q.render(o(U.StrictMode,{children:o(se,{})}),document.getElementById("root"));
